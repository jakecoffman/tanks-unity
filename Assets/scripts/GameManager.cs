using UnityEngine;using UnityEngine.Networking;using System;using System.Collections.Generic;using Random = UnityEngine.Random;public class GameManager : NetworkBehaviour {    [Serializable]    public class Count    {        public int minimum;        public int maximum;        public Count(int min, int max)        {            minimum = min;            maximum = max;        }    }    public Count wallCount = new Count(5, 9);    public GameObject[] floorTiles;    public GameObject[] wallTiles;    // just to keep the hierarchy clean    private Transform boardHolder;    // just for randomness    private List<Vector3> gridPositions = new List<Vector3>();    public IEnumerator<Vector3> spawnPoints;    // set by lobby    int columns;    int rows;    [Server]    void InitList()    {        gridPositions.Clear();        // fill the innerds of the board, leave outer open to prevent impassable levels        for (int x=1; x < columns -1; x++)        {            for (int y=1; y<rows-1; y++)            {                gridPositions.Add(new Vector3(x, y, 0f));            }        }    }    [Server]    void BoardSetup()    {        boardHolder = new GameObject("Board").transform;        for (int x=-1; x<columns+1; x++)        {            for (int y=-1; y<rows+1; y++)            {                GameObject toInstantiate = floorTiles[Random.Range(0, floorTiles.Length)];                if (x == -1 || x == columns || y == -1 || y == rows)                {                    toInstantiate = wallTiles[Random.Range(0, wallTiles.Length)];                }                GameObject instance = Instantiate(toInstantiate, new Vector3(x, y, 0f), Quaternion.identity) as GameObject;                instance.transform.SetParent(boardHolder);                NetworkServer.Spawn(instance);            }        }    }    [Server]    Vector3 RandomPos()    {        int randomIndex = Random.Range(0, gridPositions.Count);        Vector3 randomPos = gridPositions[randomIndex];        gridPositions.RemoveAt(randomIndex);        return randomPos;    }    [Server]    void LayoutObjectAtRandom(GameObject[] tileArray, int minimum, int maximum)    {        int objectCount = Random.Range(minimum, maximum + 1);        for (int i=0; i<objectCount; i++)        {            Vector3 randomPos = RandomPos();            GameObject tileChoice = tileArray[Random.Range(0, tileArray.Length)];            GameObject instance = Instantiate(tileChoice, randomPos, Quaternion.identity) as GameObject;            instance.transform.SetParent(boardHolder);            NetworkServer.Spawn(instance);        }    }    public override void OnStartServer()    {        // make outer walls        BoardSetup();        // prepare for randomness        //InitList();        // make random interesting walls        //LayoutObjectAtRandom(wallTiles, wallCount.minimum, wallCount.maximum);    }    // only for host player when running in host mode    public override void OnStartClient()    {            }    void Awake()    {        Debug.LogError("GameManager awake!");        var lobby = GameObject.Find("LobbyManager").GetComponent<MyLobbyManager>();        columns = lobby.columns;        rows = lobby.rows;        Debug.Log("" + columns + rows);    }}